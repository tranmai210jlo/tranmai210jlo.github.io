<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MXD – Dụng cụ thi công & Vật tư tin dùng</title>
  <meta name="description" content="MXD – Trung tâm tiếp thị liên kết ngành xây dựng: dụng cụ thi công, keo, máy móc. Hàng thợ tin dùng, so sánh nhanh, mua qua sàn uy tín." />
  <link rel="canonical" href="https://tranmai210jlo.github.io/" />
  
  <!-- Open Graph / Twitter Card -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://tranmai210jlo.github.io/">
  <meta property="og:title" content="MXD – Dụng cụ thi công & Vật tư tin dùng">
  <meta property="og:description" content="Trung tâm tiếp thị liên kết ngành xây dựng: dụng cụ thi công, keo, máy móc. Hàng thợ tin dùng.">
  <meta property="og:image" content="/assets/og-home.jpg">
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="MXD – Dụng cụ thi công & Vật tư tin dùng" />
  <meta name="twitter:description" content="Trung tâm tiếp thị liên kết ngành xây dựng: dụng cụ thi công, keo, máy móc. Hàng thợ tin dùng." />
  <meta name="twitter:image" content="/assets/og-home.jpg" />

  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e5e7eb; --brand:#22d3ee; --brand2:#60a5fa;
      --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444; --border:#1f2a44; --chip:#0b213a;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:1200px;margin:0 auto;padding:0 16px}

    /* Header */
    header{position:sticky;top:0;z-index:50;background:rgba(11,18,32,.8);backdrop-filter:saturate(1.4) blur(10px);border-bottom:1px solid var(--border)}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:16px;min-height:64px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.5px}
    .logo-badge{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand2));display:grid;place-items:center;font-weight:800;color:#001018}
    .menu{display:flex;gap:14px;flex-wrap:wrap}
    .menu a{padding:8px 10px;border-radius:8px;color:var(--muted)}
    .menu a:hover{background:#0e1b2f;color:var(--text)}
    .cta{display:flex;gap:10px}
    .btn{border:1px solid var(--border);background:#0d1a30;color:var(--text);padding:10px 14px;border-radius:12px}
    .btn:hover{border-color:#29456d}
    .btn-primary{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#03131a;border:none}

    /* Hero */
    .hero{padding:56px 0;background:radial-gradient(60% 60% at 50% 0%, #0f2746 0%, transparent 60%)}
    .hero .wrap{display:grid;grid-template-columns:1.1fr .9fr;gap:24px;align-items:center}
    .hero h1{margin:0 0 8px;font-size:clamp(28px,5vw,42px)}
    .hero p{color:var(--muted);margin:0 0 16px}
    .hero .card{background:linear-gradient(180deg,#0b1a2d,#0c1221);border:1px solid var(--border);border-radius:16px;padding:18px}

    /* Chips */
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{background:var(--chip);border:1px solid var(--border);padding:6px 10px;border-radius:999px;color:#cbd5e1;font-size:13px}

    /* Section title */
    .section{padding:32px 0}
    .section h2{margin:0 0 8px;font-size:clamp(22px,4vw,28px)}
    .section p.lead{margin:0 0 18px;color:var(--muted)}

    /* Filters */
    .filters{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 20px}
    .input, select{background:#0e1930;border:1px solid var(--border);color:var(--text);border-radius:10px;padding:10px 12px}
    .input::placeholder{color:#8da0bf}

    /* Grid products */
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    @media (max-width:1000px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:700px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:420px){.grid{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg,#0b1220,#0f172a);border:1px solid var(--border);border-radius:16px;overflow:hidden}
    .card .thumb{aspect-ratio:4/3;background:#0c213a;display:grid;place-items:center}
    .card .body{padding:12px 12px 14px;display:grid;gap:8px}
    .title{font-weight:600}
    .price{display:flex;align-items:baseline;gap:8px}
    .price .now{font-weight:800}
    .price .old{color:#93a0b8;text-decoration:line-through}
    .tags{display:flex;gap:6px;flex-wrap:wrap}
    .tag{font-size:11px;background:#0b213a;border:1px solid var(--border);color:#c4d3ea;padding:4px 8px;border-radius:999px}
    .actions{display:flex;gap:8px}
    .btn-sm{padding:8px 10px;border-radius:10px}

    /* Drawer cart */
    .drawer{position:fixed;right:0;top:0;bottom:0;width:min(420px,100%);background:#0c1528;border-left:1px solid var(--border);transform:translateX(100%);transition:.25s ease;z-index:70;display:flex;flex-direction:column}
    .drawer.open{transform:none}
    .drawer header{position:sticky;top:0;background:#0c1528;border-bottom:1px solid var(--border)}
    .drawer h3{margin:0;padding:14px 16px}
    .drawer .items{flex:1;overflow:auto;padding:12px}
    .cart-item{display:grid;grid-template-columns:64px 1fr auto;gap:10px;border:1px solid var(--border);border-radius:12px;padding:10px;margin-bottom:10px;background:#0b1a2e}
    .cart-item .qty{display:flex;align-items:center;gap:6px}
    .drawer footer{border-top:1px solid var(--border);padding:12px;display:grid;gap:10px}

    /* Member form */
    form .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:700px){form .row{grid-template-columns:1fr}}
    label{font-size:13px;color:#9fb0c9}
    input, textarea{background:#0e1930;border:1px solid var(--border);color:var(--text);border-radius:10px;padding:10px 12px;width:100%}
    textarea{min-height:96px}

    /* News (fallback cards) */
    .news{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.news{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:560px){.news{grid-template-columns:1fr}}
    .news .ncard{border:1px solid var(--border);border-radius:16px;overflow:hidden;background:#0b1426}
    .news .cover{aspect-ratio:16/9;background:linear-gradient(135deg,#0b213a,#122b4b)}
    .news .body{padding:12px}

    /* Services */
    .services{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.services{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:560px){.services{grid-template-columns:1fr}}
    .svc{border:1px solid var(--border);border-radius:16px;padding:14px;background:#0b1426}

    /* Footer & policies */
    footer{border-top:1px solid var(--border);background:#08101f;margin-top:24px}
    .fgrid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:16px;padding:20px 0}
    @media (max-width:900px){.fgrid{grid-template-columns:1fr 1fr}}
    @media (max-width:560px){.fgrid{grid-template-columns:1fr}}
    .fgrid h4{margin:0 0 10px}
    .copyright{border-top:1px solid var(--border);padding:10px 0;color:#97a6c5}

    /* Floating contact */
    .contact-fab{position:fixed;right:16px;bottom:16px;display:grid;gap:10px;z-index:80}
    .fab{display:grid;place-items:center;width:54px;height:54px;border-radius:999px;background:linear-gradient(135deg,var(--brand),var(--brand2));color:#001018;font-weight:800;box-shadow:0 14px 32px rgba(0,0,0,.35)}
    .fab:hover{filter:saturate(1.1)}

    /* Back-to-top / Home */
    .to-top{position:fixed;left:16px;bottom:16px;opacity:0;pointer-events:none;transition:.2s}
    .to-top.show{opacity:1;pointer-events:auto}

    /* Utility */
    .muted{color:var(--muted)}
    .hidden{display:none}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a href="#" class="logo" aria-label="Trang chủ MXD">
        <span class="logo-badge">MXD</span> MXD – Dụng cụ thi công
      </a>
      <nav class="menu" aria-label="Điều hướng chính">
  <a href="/">Trang chủ</a>
  <a href="#san-pham">Sản phẩm</a>
  <a href="#tin-tuc">Tin tức & Kinh nghiệm</a>
  <a href="#dich-vu">Dịch vụ</a>
  <a href="#dang-ky">Thành viên</a>
  <a href="#chinh-sach">Chính sách</a>
</nav>

      <div class="cta">
        <button class="btn" id="btnCart" aria-label="Mở giỏ hàng">Giỏ hàng (<span id="cartCount">0</span>)</button>
        <a class="btn btn-primary" href="#san-pham">Mua ngay</a>
      </div>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <div class="container wrap">
        <div>
          <h1>MXD Trung Tâm Mua Sắm Ngành Xây Dựng</h1>
<p>MXD tuyển từ Lazada, Shopee, TikTok Shop, Tiki…: chỉ những sản phẩm được ưa chuộng nhất - chất lượng nhất — bền bỉ, tối ưu chi phí.</p>

          <div class="chips">
            <span class="chip">Máy móc</span>
            <span class="chip">Keo & Vật liệu</span>
            <span class="chip">Dụng cụ đo</span>
            <span class="chip">An toàn lao động</span>
          </div>
        </div>
        <div class="card">
  <strong>Cam kết chọn lọc:</strong>
  <p class="muted">Ưu tiên sản phẩm có đánh giá thật và nhà bán uy tín; dẫn link an toàn; không can thiệp giá niêm yết.</p>
  <div class="chips" style="margin-top:6px">
    <span class="chip">Nguồn chính hãng</span>
    <span class="chip">Đánh giá cao & ổn định</span>
    <span class="chip">Dẫn link an toàn</span>
  </div>
</div>

        </div>
      </div>
    </section>

    <!-- PRODUCTS -->
    <section id="san-pham" class="section">
      <div class="container">
        <h2>Sản phẩm nổi bật</h2>
        <p class="lead">“Mua ngay” khi bạn sẵn sàng; “Thêm vào giỏ” nếu còn muốn xem tiếp.</p>


        <div class="filters">
          <input class="input" id="q" placeholder="Tìm theo tên, mã, tag…" />
          <select id="cat">
            <option value="">Tất cả danh mục</option>
          </select>
          <button class="btn" id="btnReset">Làm mới</button>
        </div>

        <div id="grid" class="grid" aria-live="polite"></div>
      </div>
    </section>

    <!-- MEMBER FORM -->
    <section id="dang-ky" class="section">
      <div class="container">
        <h2>Đăng ký thành viên</h2>
        <p class="lead">Nhận ưu đãi & cập nhật sản phẩm phù hợp công trình của bạn.</p>
        <form id="memberForm" class="card" onsubmit="return false">
          <div class="row">
            <div>
              <label>Họ và tên</label>
              <input id="mName" required placeholder="Tên thợ/đơn vị" />
            </div>
            <div>
              <label>Số điện thoại</label>
              <input id="mPhone" required placeholder="09xxxxxxxx" />
            </div>
          </div>
          <div class="row">
            <div>
              <label>Email</label>
              <input id="mEmail" type="email" placeholder="you@example.com" />
            </div>
            <div>
              <label>Nhu cầu</label>
              <input id="mNeed" placeholder="Máy cắt, keo ốp lát, an toàn…" />
            </div>
          </div>
          <div>
            <label>Ghi chú</label>
            <textarea id="mNote" placeholder="Mô tả công trình/tiêu chí chọn hàng…"></textarea>
          </div>
          <div style="display:flex;gap:10px;align-items:center">
            <button class="btn btn-primary" id="btnMember">Gửi đăng ký</button>
            <span id="memberMsg" class="muted"></span>
          </div>
        </form>
      </div>
    </section>

    <!-- NEWS (fallback static) -->
    <section id="tin-tuc" class="section">
      <div class="container">
        <h2>Tin tức & Kinh nghiệm</h2>
        <p class="lead">Ba bài viết mẫu (fallback SEO). Khi có dữ liệu JSON, ta sẽ render động.</p>
        <div class="news" id="news">
          <article class="ncard">
            <div class="cover"></div>
            <div class="body">
              <h3 style="margin:0 0 6px">Thi công chống thấm: 5 lỗi nhỏ, hậu quả lớn</h3>
              <p class="muted">Kinh nghiệm từ công trình thực tế: chọn keo, xử lý mạch ngừng, kiểm tra nước…</p>
            </div>
          </article>
          <article class="ncard">
            <div class="cover"></div>
            <div class="body">
              <h3 style="margin:0 0 6px">Chọn máy cắt gạch: lưỡi, công suất, độ bền</h3>
              <p class="muted">Phân khúc 600–1200W cho thợ thi công dân dụng – gợi ý mẫu tin dùng.</p>
            </div>
          </article>
          <article class="ncard">
            <div class="cover"></div>
            <div class="body">
              <h3 style="margin:0 0 6px">An toàn lao động: kính – găng – tai nghe</h3>
              <p class="muted">Bộ 3 phải có khi cắt/đục: giảm rủi ro nhưng không vướng tay.</p>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- SERVICES -->
    <section id="dich-vu" class="section">
      <div class="container">
        <h2>Dịch vụ MXD</h2>
        <p class="lead">Tư vấn chọn sản phẩm – chuẩn hóa bộ vật tư – tối ưu chi phí theo hạng mục.</p>
        <div class="services">
          <div class="svc"><strong>Bộ vật tư lát nền</strong><p class="muted">Bay răng cưa, gạt vữa, keo ốp lát theo mác gạch & kích thước.</p></div>
          <div class="svc"><strong>Chống thấm nhà vệ sinh</strong><p class="muted">Checklist vật tư & quy trình test nước, hạn chế thấm ngược.</p></div>
          <div class="svc"><strong>Thiết bị cắt – mài</strong><p class="muted">Lựa chọn máy, lưỡi cắt, kính bảo hộ – an toàn vẫn đẹp mạch.</p></div>
        </div>
      </div>
    </section>

    <!-- POLICIES -->
    <section id="chinh-sach" class="section">
      <div class="container">
        <h2>Chính sách</h2>
        <p class="lead">Minh bạch & bảo mật khi bạn mua qua liên kết.</p>
        <ul>
          <li><a href="/chinh-sach/doi-tra.html">Chính sách đổi trả</a></li>
          <li><a href="/chinh-sach/giao-hang.html">Chính sách giao hàng</a></li>
          <li><a href="/chinh-sach/bao-mat.html">Chính sách bảo mật</a></li>
          <li><a href="/chinh-sach/affiliate.html">Công bố liên kết tiếp thị (affiliate)</a></li>
        </ul>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="container fgrid">
      <div>
        <h4>MXD</h4>
        <p class="muted">Trung tâm tiếp thị liên kết ngành xây dựng. Tối ưu & bền vững.</p>
      </div>
      <div>
        <h4>Danh mục</h4>
        <p><a href="#san-pham">Sản phẩm</a><br><a href="#tin-tuc">Tin tức & Kinh nghiệm</a><br><a href="#dich-vu">Dịch vụ</a></p>
      </div>
      <div>
        <h4>Liên hệ</h4>
        <p><a id="lnCall" href="#">Gọi</a><br><a id="lnZalo" target="_blank" rel="noopener">Zalo</a><br><a id="lnMsg" target="_blank" rel="noopener">Messenger</a></p>
      </div>
      <div>
        <h4>Chính sách</h4>
        <p><a href="#chinh-sach">Xem tất cả</a></p>
      </div>
    </div>
    <div class="container copyright">© <span id="y"></span> MXD. Một số liên kết là affiliate; MXD có thể nhận hoa hồng.</div>
  </footer>

  <!-- FLOATING CONTACT -->
  <a class="fab" id="fabZalo" href="#" target="_blank" rel="noopener" title="Zalo" aria-label="Zalo">
  <svg width="26" height="26" viewBox="0 0 48 48" aria-hidden="true">
    <rect width="48" height="48" rx="10" fill="#0068FF"></rect>
    <text x="50%" y="58%" text-anchor="middle" font-size="24" font-family="Inter,Arial" fill="#fff">Z</text>
  </svg>
</a>


  <a href="/" class="btn btn-primary to-top show" id="toTop" aria-label="Trang chủ">Trang chủ</a>


  <!-- CART DRAWER -->
  <aside class="drawer" id="cartDrawer" aria-hidden="true" aria-label="Giỏ hàng">
    <header><h3 class="container">Giỏ hàng</h3></header>
    <div class="items" id="cartItems"></div>
    <footer>
      <div style="display:flex;justify-content:space-between"><span class="muted">Tổng sản phẩm:</span><strong id="cartTotalQty">0</strong></div>
      <div style="display:flex;justify-content:space-between"><span class="muted">Tạm tính:</span><strong id="cartTotal">0₫</strong></div>
      <button class="btn btn-primary" id="btnCheckout">Thanh toán (mở link sàn)</button>
      <button class="btn" id="btnCloseCart">Đóng</button>
    </footer>
  </aside>

  <!-- JSON-LD Organization & Website -->
  <script type="application/ld+json" id="orgLD">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"MXD",
    "url":"https://tranmai210jlo.github.io/",
    "logo":"https://tranmai210jlo.github.io/assets/og-home.jpg"
  }
  </script>
  <script type="application/ld+json" id="siteLD">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"MXD – Dụng cụ thi công & Vật tư",
    "url":"https://tranmai210jlo.github.io/",
    "potentialAction":{
      "@type":"SearchAction",
      "target":"https://tranmai210jlo.github.io/?q={search_term_string}",
      "query-input":"required name=search_term_string"
    }
  }
  </script>

  <script>
  // =======================
  //  CONFIG & DATA (edit)
  // =======================
  const CONTACT = {
    phone: '033832-8898',
    telHref: 'tel:0338328898',
    zalo: 'https://zalo.me/0338328898',
    messenger: 'https://m.me/your.page',
  };

  const CATEGORIES = [
    'Máy móc', 'Keo & Vật liệu', 'Dụng cụ đo', 'Dụng cụ cắt', 'An toàn lao động'
  ];

  const PRODUCTS = [
    {id:'mx-001', name:'Máy cắt gạch 800W', cat:'Máy móc', price:1290000, old:1590000, tags:['máy cắt','gạch','800W'], url:'#', img:'', spec:{congsuat:'800W',trongluong:'2.3kg'}},
    {id:'mx-002', name:'Máy mài đa năng 650W', cat:'Máy móc', price:990000, old:0, tags:['máy mài','650W'], url:'#', img:'', spec:{congsuat:'650W',trongluong:'1.8kg'}},
    {id:'mx-003', name:'Keo ốp lát gạch mác C2', cat:'Keo & Vật liệu', price:185000, old:210000, tags:['keo','ốp lát','C2'], url:'#', img:'', spec:{khoi:'25kg',ungdung:'Gạch 60–80'}},
    {id:'mx-004', name:'Keo chống thấm hai thành phần', cat:'Keo & Vật liệu', price:265000, old:0, tags:['chống thấm'], url:'#', img:'', spec:{dinhmuc:'1.2kg/m²',ungdung:'WC/sân thượng'}},
    {id:'mx-005', name:'Bay răng cưa 40cm', cat:'Dụng cụ cắt', price:95000, old:0, tags:['bay','răng cưa','40cm'], url:'#', img:'', spec:{chieuDai:'40cm',vatlieu:'Thép không gỉ'}},
    {id:'mx-006', name:'Gạt vữa lát nền 60cm', cat:'Dụng cụ cắt', price:145000, old:0, tags:['gạt vữa','60cm'], url:'#', img:'', spec:{chieuDai:'60cm',vatlieu:'Nhôm + cao su'}},
    {id:'mx-007', name:'Thước thủy nhôm 80cm', cat:'Dụng cụ đo', price:120000, old:0, tags:['thước thủy','80cm'], url:'#', img:'', spec:{chieuDai:'80cm',doChinhXac:'0.5mm/m'}},
    {id:'mx-008', name:'Máy cân bằng tia laser 12 tia', cat:'Dụng cụ đo', price:1690000, old:1990000, tags:['laser','12 tia'], url:'#', img:'', spec:{pin:'Lithium',phuKien:'Chân máy'}},
    {id:'mx-009', name:'Kính bảo hộ trong suốt', cat:'An toàn lao động', price:35000, old:0, tags:['kính','an toàn'], url:'#', img:'', spec:{chongUV:'Yes'}},
    {id:'mx-010', name:'Găng tay chống cắt cấp 5', cat:'An toàn lao động', price:65000, old:0, tags:['găng tay','chống cắt'], url:'#', img:'', spec:{cap:'EN388 Cấp 5'}},
  ];

  // =======================
  //  UTILITIES
  // =======================
  const $ = s => document.querySelector(s);
  const $$ = s => [...document.querySelectorAll(s)];
  const fmtVND = n => (n||0).toLocaleString('vi-VN')+'₫';
  const esc = s => (s+'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));

  function placeholderSVG(text){
    const t = encodeURIComponent((text||'MXD').slice(0,18));
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='600'>\
      <defs><linearGradient id='g' x1='0' x2='1' y1='0' y2='1'>\
        <stop offset='0%' stop-color='%2322d3ee'/><stop offset='100%' stop-color='%2360a5fa'/>\
      </linearGradient></defs>\
      <rect width='100%' height='100%' fill='%230b213a'/>\
      <rect x='0' y='0' width='100%' height='100%' fill='url(%23g)' opacity='0.15'/>\
      <text x='50%' y='52%' dominant-baseline='middle' text-anchor='middle' font-size='56' fill='%23cfe8ff' font-family='Inter,Segoe UI,Arial'>${t}</text>\
    </svg>`;
    return 'data:image/svg+xml;charset=UTF-8,'+svg.replace(/\n/g,'');
  }

  // =======================
  //  RENDER PRODUCTS
  // =======================
  function buildCategoryOptions(){
    const sel = $('#cat');
    CATEGORIES.forEach(c=>{
      const opt = document.createElement('option');
      opt.value = c; opt.textContent = c; sel.appendChild(opt);
    });
  }

  function productCard(p){
    const img = p.img || placeholderSVG(p.name);
    const tags = (p.tags||[]).map(t=>`<span class="tag">${esc(t)}</span>`).join('');
    const old = p.old>0 ? `<span class="old">${fmtVND(p.old)}</span>` : '';
    return `<div class="card" data-id="${esc(p.id)}" data-cat="${esc(p.cat)}" data-tags="${esc((p.tags||[]).join(','))}">
      <div class="thumb"><img src="${img}" alt="${esc(p.name)}" loading="lazy" width="800" height="600"></div>
      <div class="body">
        <div class="title">${esc(p.name)}</div>
        <div class="muted" style="font-size:13px">${esc(p.cat)}</div>
        <div class="price"><span class="now">${fmtVND(p.price)}</span>${old}</div>
        <div class="tags">${tags}</div>
        <div class="actions">
          <button class="btn btn-sm" data-add>Thêm vào giỏ</button>
          <a class="btn btn-sm btn-primary" href="${p.url||'#'}" target="_blank" rel="sponsored nofollow noopener">Mua ngay</a>
        </div>
      </div>
    </div>`;
  }

  function renderProducts(){
    const q = ($('#q').value||'').toLowerCase().trim();
    const cat = $('#cat').value;
    const list = PRODUCTS.filter(p => {
      const okCat = !cat || p.cat === cat;
      const blob = (p.name+' '+p.id+' '+(p.tags||[]).join(' ')).toLowerCase();
      const okQ = !q || blob.includes(q);
      return okCat && okQ;
    });
    $('#grid').innerHTML = list.map(productCard).join('');
    // Bind add-to-cart
    $$('#grid [data-add]').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const card = e.target.closest('.card');
        const id = card.dataset.id;
        const item = PRODUCTS.find(x=>x.id===id);
        addToCart(item);
      });
    });
    // Generate Product JSON-LD (first 10)
    injectProductLD(list.slice(0,10));
  }

  // =======================
  //  CART LOGIC
  // =======================
  const CART = new Map(); // id -> {item, qty}

  function addToCart(item, qty=1){
    const cur = CART.get(item.id) || {item, qty:0};
    cur.qty += qty; CART.set(item.id, cur);
    updateCartUI(); openCart();
  }
  function removeFromCart(id){ CART.delete(id); updateCartUI(); }
  function changeQty(id, delta){ const cur=CART.get(id); if(!cur) return; cur.qty=Math.max(1,cur.qty+delta); updateCartUI(); }

  function updateCartUI(){
    const items = [...CART.values()];
    $('#cartCount').textContent = items.reduce((s,x)=>s+x.qty,0);
    $('#cartTotalQty').textContent = $('#cartCount').textContent;
    const sum = items.reduce((s,x)=>s+x.item.price*x.qty,0);
    $('#cartTotal').textContent = fmtVND(sum);
    $('#cartItems').innerHTML = items.map(({item,qty})=>`
      <div class="cart-item">
        <div class="thumb"><img src="${item.img||placeholderSVG(item.name)}" alt="${esc(item.name)}" width="120" height="90"></div>
        <div>
          <div style="font-weight:600">${esc(item.name)}</div>
          <div class="muted" style="font-size:13px">${fmtVND(item.price)} · ${esc(item.cat)}</div>
          <div class="qty"><button class="btn btn-sm" data-dec="${item.id}">–</button> ${qty} <button class="btn btn-sm" data-inc="${item.id}">+</button></div>
        </div>
        <div>
          <button class="btn" data-del="${item.id}">Xóa</button>
        </div>
      </div>
    `).join('') || '<p class="muted">Giỏ hàng trống.</p>';

    // bind buttons
    $$('#cartItems [data-del]').forEach(b=>b.addEventListener('click', e=>removeFromCart(e.target.dataset.del)));
    $$('#cartItems [data-inc]').forEach(b=>b.addEventListener('click', e=>changeQty(e.target.dataset.inc, +1)));
    $$('#cartItems [data-dec]').forEach(b=>b.addEventListener('click', e=>changeQty(e.target.dataset.dec, -1)));
  }

  function openCart(){ $('#cartDrawer').classList.add('open'); $('#cartDrawer').setAttribute('aria-hidden','false'); }
  function closeCart(){ $('#cartDrawer').classList.remove('open'); $('#cartDrawer').setAttribute('aria-hidden','true'); }

  // Checkout: mở mỗi URL 1 lần (lọc trùng), thêm rel an toàn
  function checkout(){
    const urls = new Set();
    CART.forEach(({item})=>{ if(item.url && item.url !== '#') urls.add(item.url); });
    if(urls.size===0){ alert('Chưa có sản phẩm có link sàn. Hãy thay URL affiliate trước.'); return; }
    urls.forEach(u=> window.open(u, '_blank', 'noopener'));
  }

  // =======================
  //  MEMBER FORM (basic demo)
  // =======================
  $('#btnMember').addEventListener('click', ()=>{
    $('#memberMsg').textContent = 'Đang gửi đăng ký…';
    setTimeout(()=>{
      $('#memberMsg').textContent = 'Đã ghi nhận! MXD sẽ liên hệ sớm.';
      // TODO: thay bằng Formspree/Google Forms action
    }, 450);
  });

  // =======================
  //  MISC: contact links, toTop
  // =======================
  function bindContacts(){
    $('#lnCall').href = CONTACT.telHref;
    $('#lnZalo').href = CONTACT.zalo;
    $('#lnMsg').href = CONTACT.messenger;
    $('#fabCall').href = CONTACT.telHref;
    $('#fabZalo').href = CONTACT.zalo;
    $('#fabMsg').href = CONTACT.messenger;
  }
  function onScroll(){
    if(window.scrollY>300) $('#toTop').classList.add('show'); else $('#toTop').classList.remove('show');
  }

  // =======================
  //  PRODUCT JSON-LD (from list)
  // =======================
  function injectProductLD(list){
    const json = list.map(p=>({
      '@context':'https://schema.org', '@type':'Product',
      name: p.name, sku: p.id, category: p.cat,
      image: p.img || placeholderSVG(p.name),
      offers: { '@type':'Offer', priceCurrency:'VND', price: String(p.price), availability:'https://schema.org/InStock' }
    }));
    let tag = document.getElementById('prodLD');
    if(!tag){ tag = document.createElement('script'); tag.type='application/ld+json'; tag.id='prodLD'; document.body.appendChild(tag); }
    tag.textContent = JSON.stringify(json);
  }

  // =======================
  //  INIT
  // =======================
  buildCategoryOptions();
  renderProducts();
  bindContacts();
  $('#y').textContent = new Date().getFullYear();

  // Events
  $('#q').addEventListener('input', renderProducts);
  $('#cat').addEventListener('change', renderProducts);
  $('#btnReset').addEventListener('click', ()=>{ $('#q').value=''; $('#cat').value=''; renderProducts(); });

  $('#btnCart').addEventListener('click', openCart);
  $('#btnCloseCart').addEventListener('click', closeCart);
  $('#btnCheckout').addEventListener('click', checkout);
  window.addEventListener('scroll', onScroll);
  onScroll();
  </script>
</body>
</html>
